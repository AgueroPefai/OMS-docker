[SERVICE]
    Flush         1
    Log_Level     info
    Daemon        off
    Parsers_File  parsers.conf
    Log_File      /var/log/fluent-bit.log
    HTTP_Server   On
    HTTP_Listen   0.0.0.0
    HTTP_Port     2020

[INPUT]
    Name tail
    Tag oms.container.log.*
    Interval_Sec 5
    Path /var/log/containers/*.log
    Exclude_Path *azureproxy*.log,*kube-dns*.log,*kubernetes-dashboard*.log,*heapster*.log,*addon-http-application*.log,*omsagent*.log,*tunnelfront*.log,*kube-svc*log
    DB /var/log/fblogs.db
    Parser docker

[FILTER]
    Name kubernetes
    Match oms.container.log.*
    Kube_URL https://kubernetes.default.svc.cluster.local:443
    Merge_JSON_Log On
    K8S-Logging.Parser  On
[FILTER]
    Name nest
    Match oms.container.log.*
    Operation lift
    Nested_under kubernetes
[FILTER]
    Name record_modifier
    Match oms.container.log.*
    Whitelist_key log
    Whitelist_key stream
    Whitelist_key time
    Whitelist_key docker_id
    Whitelist_key pod_name
    Whitelist_key host
[FILTER]
    Name modify
    Match oms.container.log.*
    Rename log LogEntry
    Rename stream LogEntrySource
    Rename time LogEntryTimeStamp
    Rename docker_id Id
    Rename pod_name Name
    Add_if_not_present SourceSystem Containers
    Rename host Computer

[OUTPUT]
    Name            oms
    Match           oms.container.log.*
